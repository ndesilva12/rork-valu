rules_version = '2';

// Firebase Storage Security Rules for Stand App
// Note: This app uses Clerk for authentication, not Firebase Auth,
// so request.auth is not available. Using permissive rules for now.
service firebase.storage {
  match /b/{bucket}/o {

    // Profile images - allow uploads and reads
    match /profile-images/{fileName} {
      // Allow public read access (profile images should be viewable)
      allow read: if true;

      // Allow write if:
      // 1. File size is less than 5MB
      // 2. File is an image
      allow write: if request.resource.size < 5 * 1024 * 1024
                   && request.resource.contentType.matches('image/.*');
    }

    // Business images - allow uploads and reads
    match /business-images/{fileName} {
      // Allow public read access (business logos should be viewable)
      allow read: if true;

      // Allow write if:
      // 1. File size is less than 5MB
      // 2. File is an image
      allow write: if request.resource.size < 5 * 1024 * 1024
                   && request.resource.contentType.matches('image/.*');
    }

    // Business cover images - allow uploads and reads
    match /business-cover-images/{fileName} {
      // Allow public read access (cover images should be viewable)
      allow read: if true;

      // Allow write if:
      // 1. File size is less than 5MB
      // 2. File is an image
      allow write: if request.resource.size < 5 * 1024 * 1024
                   && request.resource.contentType.matches('image/.*');
    }

    // Business gallery images - allow uploads and reads
    match /business-gallery-images/{fileName} {
      // Allow public read access (gallery images should be viewable)
      allow read: if true;

      // Allow write if:
      // 1. File size is less than 5MB
      // 2. File is an image
      allow write: if request.resource.size < 5 * 1024 * 1024
                   && request.resource.contentType.matches('image/.*');
    }

    // Deny all other access
    match /{allPaths=**} {
      allow read, write: if false;
    }
  }
}
